# Falt-Tolerant VM
目的：实现一个自动容错的虚拟机主从备份系统，当虚拟机出问题时，备份虚拟机上线，且外界无法感知异常。


# 难点，哪些情况主备会出现分歧。
- 外部输入顺序不同，如果输入顺序到达主备不同会导致不一致。解决方法就是锁服务。备份节点必须和主节点执行相同顺序的操作。

- 时间片轮转中断，主节点感知时间片轮转通过log传递给备份节点，备份节点的时间片不能由硬件控制而是由ft的log channel来控制这样才能够保证和主节点的一致性。ft感知何时触发时间片轮转中断然后再让备份节点重新运转。必须要模拟中断，这样才能保证主备执行的指令流是一致的。


-  遇到状态操作类似获取计数器或者时间戳。方法是ft感知到这些指令后触发中断，得到结果后将结果发送给备份节点。备份节点在ft感知后不执行这些操作而是等待结果。注意备节点始终会比主节点慢最少一个entry，备节点需要看到下一条entry到达后才能安全的执行当前的entry，依旧是为了保障一致性


# Q&A
Q:随机数可以确定吗？

A:可以，hypervisor精确控制vm内部的一切

Q:容错只针对fail-stop类型有实际意义吗？

A: 有的，真实世界绝大部分错误是fail-stop类型的，比如网络中断，断电，系统crash。对于人为的攻击，以及大量non-fail-stop类型的错误，被称为拜占庭问题，这类问题有解决办法，当然主要是依赖复制和通信达成共识，6.824课程中几乎不涉及这类问题，会在课程最后简单介绍.
