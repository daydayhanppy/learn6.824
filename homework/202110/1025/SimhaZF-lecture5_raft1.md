# Raft
# 脑裂
之前谈论的MapReduce，GFS，VmFT都是有主节点的，当主备之间网络出现问题时，同时存在两个或以上的主节点时，就会存在脑裂现象。
# 过半票决
服务器需要是奇数，当存在网络分区时，只会有一个分区具有一半以上的服务器数量。只有凑齐半数以上（总服务器数量的一半）的服务器才能够批准相应的操作。

> 如果系统有 2 * F + 1 个服务器，那么系统最多可以接受F个服务器出现故障，仍然可以正常工作。

Raft采用majority的方法选择leader，那么新旧任换届的时候，新的leader所收到的过半服务器的信息中必定含有旧leader的信息。所以Raft能够正常运行。

# Raft的基本运作
当客户端在与一个多副本服务器交互的时候，客户端是无感知的。但是主副本当收到请求时，会先下发到Raft层，Raft节点直接会互相交互，当过半节点将新操作更新到他们的log中，这个操作就被commit了。然后Raft就会告知应用程序可以执行这条命令。（当主节点知道过半复制成功时，会通知其他节点可以上传到应用程序也就是数据库中进行更新，那么其他的副本也就更新了）

# log
所有节点都需要保存log这样有助于离群的服务器回归。

而且leader中保存有log可以重传给丢失的follower。
