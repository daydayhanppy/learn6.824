# Raft是什么？
Raft是一种一致性算法，目的是将日志完整无误的复制到集群的每一个服务器中。

# 为什么要有Raft？
在Raft发明之前。解决一致性问题基本都使用的是Paxos算法。Paxos算法是正确的，但是有两个缺点：

1. 难以理解
2. 难以实践 

# Raft的限定条件
Raft针对的服务器不可以发生拜占庭错误。
# Raft是怎么保障一致性的？
复制状态机。只需要每个服务器按照相同顺序执行指令，每个状态机的最终状态就都是确认的。所以我们需要复制日志。

Raft使用强领导者，领导选举的方法是随机。那么一致性问题拆分为：
- 领导选举：总要保持一个领导在线
- 日志复制：领导人从客户端接收log entries。然后分发给每一个服务器，要求每个服务器日志都必须和自己保持相同
- 安全性：怎么避免不同状态机可能执行不同操作指令

# Raft算法纵览
1. 怎么选择领导者？领导者崩溃时怎么选择另一个替代它。
2. 日志复制
3. 领导者发生改变后怎么确保安全性和一致性的。
4. 崩溃的领导者恢复后如何回归
5. 客户端如何和集群交互。怎么确保服务器的命令是线性的，即操作只执行一次。
6. 如何增加和移除服务器


# 服务器状态
- 领导者：只会有一个领导者，负责与客户端交互和日志复制同步。
- 候选者：只有当换届的时候才会出现的短暂状态。正常状态是1个领导者，n-1个跟随者。
- 跟随者：只会响应RPC。本身不会发出RPC调用
  
# 任期（term）
这是一个很重要的概念，可以使Raft判断过期的信息。
- 时序被分割为很多个任期，每一个任期都由选举期开始。每一个任期会被分为两个片段：选举期和正常担任领导者的时间。
- 每一个任期只会有一个领导者
- 选举失败则立马开始下一个任期
- 每一个服务器都保存（非易失介质）当前任期。这样崩溃后可以迅速恢复。
- 只会使用最新任期的信息
